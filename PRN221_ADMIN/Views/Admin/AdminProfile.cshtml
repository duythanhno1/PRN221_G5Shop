@{
    ViewData["Title"] = "AdminProfile";
    Layout = "~/Views/Shared/_Layout.cshtml";

}
<div class="page-wrapper">
    <!-- Top Bar Start -->
    <div class="topbar">
        <!-- Navbar -->
        <nav class="navbar-custom">
            <ul class="list-unstyled topbar-nav float-end mb-0">
                <li class="dropdown hide-phone">
                    <a class="nav-link dropdown-toggle arrow-none waves-light waves-effect" data-bs-toggle="dropdown" href="#" role="button"
                       aria-haspopup="false" aria-expanded="false">
                        <i data-feather="search" class="topbar-icon"></i>
                    </a>

                    <div class="dropdown-menu dropdown-menu-end dropdown-lg p-0">
                        <!-- Top Search Bar -->
                        <div class="app-search-topbar">
                            <form action="#" method="get">
                                <input type="search" name="search" class="from-control top-search mb-0" placeholder="Type text...">
                                <button type="submit"><i class="ti-search"></i></button>
                            </form>
                        </div>
                    </div>
                </li>

                <li class="dropdown notification-list">
                    <a class="nav-link dropdown-toggle arrow-none waves-light waves-effect" data-bs-toggle="dropdown" href="#" role="button"
                       aria-haspopup="false" aria-expanded="false">
                        <i data-feather="bell" class="align-self-center topbar-icon"></i>
                        <span class="badge bg-danger rounded-pill noti-icon-badge"></span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-end dropdown-lg pt-0">

                        <h6 class="dropdown-item-text font-15 m-0 py-3 border-bottom d-flex justify-content-between align-items-center">
                            Notifications <span class="badge bg-primary rounded-pill">0</span>
                        </h6>
                        <div class="notification-menu" data-simplebar>
                            <!-- item-->
                            
                        </div>
                        <!-- All-->
                        <a href="javascript:void(0);" class="dropdown-item text-center text-primary">
                            View all <i class="fi-arrow-right"></i>
                        </a>
                    </div>
                </li>

                <li class="dropdown">
                    <a class="nav-link dropdown-toggle waves-effect waves-light nav-user" data-bs-toggle="dropdown" href="#" role="button"
                       aria-haspopup="false" aria-expanded="false">
                        <span class="ms-1 nav-user-name hidden-sm">Admin</span>
                        <img src="~/admin/assets/images/users/user-5.jpg" alt="profile-user" class="rounded-circle thumb-xs" />
                    </a>
                    <div class="dropdown-menu dropdown-menu-end">
                        <a class="dropdown-item" href="@Url.Action("AdminProfile", "Admin")"><i data-feather="user" class="align-self-center icon-xs icon-dual me-1"></i> Profile</a>
                        <div class="dropdown-divider mb-0"></div>
                        <a class="dropdown-item" href="@Url.Action("Logout", "Admin")"><i data-feather="power" class="align-self-center icon-xs icon-dual me-1"></i> Logout</a>
                    </div>
                </li>
            </ul><!--end topbar-nav-->

            <ul class="list-unstyled topbar-nav mb-0">
                <li>
                    <button class="nav-link button-menu-mobile">
                        <i data-feather="menu" class="align-self-center topbar-icon"></i>
                    </button>
                </li>
               
            </ul>
        </nav>
        <!-- end navbar-->
    </div>
    <!-- Top Bar End -->
    <!-- Page Content-->
    <div class="page-content">
        <div class="container-fluid">
            <!-- Page-Title -->
            <div class="row">
                <div class="col-sm-12">
                    <div class="page-title-box">
                        <div class="row">
                            <div class="col">
                                <h4 class="page-title">Profile</h4>
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="">G5 Manager</a></li>
                                    <li class="breadcrumb-item"><a href="">Pages</a></li>
                                    <li class="breadcrumb-item active">Profile</li>
                                </ol>
                            </div><!--end col-->
                            <div class="col-auto align-self-center">
                                <a href="#" class="btn btn-sm btn-outline-primary" id="Dash_Date">
                                    <span class="day-name" id="Day_Name">Today:</span>&nbsp;
                                    <span class="" id="Select_date">Jan 11</span>
                                    <i data-feather="calendar" class="align-self-center icon-xs ms-1"></i>
                                </a>
                                <a href="#" class="btn btn-sm btn-outline-primary">
                                    <i data-feather="download" class="align-self-center icon-xs"></i>
                                </a>
                            </div><!--end col-->
                        </div><!--end row-->
                    </div><!--end page-title-box-->
                </div><!--end col-->
            </div><!--end row-->
            <!-- end page title end breadcrumb -->

            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body p-0">
                            <div id="user_map" class="pro-map" style="height: 220px"></div>
                        </div><!--end card-body-->
                        <div class="card-body">
                            <div class="dastone-profile">
                                <div class="row">
                                    <div class="col-lg-4 align-self-center mb-3 mb-lg-0">
                                        <div class="dastone-profile-main">
                                            <div class="dastone-profile-main-pic">
                                                <img src="~/admin/assets/images/users/user-5.jpg" alt="" height="110" class="rounded-circle">
                                                <span class="dastone-profile_main-pic-change">
                                                    <i class="fas fa-camera"></i>
                                                </span>
                                            </div>
                                            <div class="dastone-profile_user-detail">
                                                @if (@ViewBag.User == null)
                                                {
                                                    <h5 class="dastone-user-name">Admin</h5>
                                                }
                                                else
                                                {
                                                    <h5 class="dastone-user-name">@ViewBag.User.UserName</h5>
                                                }
                                                <p class="mb-0 dastone-user-name-post">Developer FPTU</p>
                                            </div>
                                        </div>
                                    </div><!--end col-->

                                    <div class="col-lg-4 ms-auto align-self-center">
                                        <ul class="list-unstyled personal-detail mb-0">
                                            @if (ViewBag.User == null)
                                            {
                                                <li class=""><i class="ti ti-mobile me-2 text-secondary font-16 align-middle"></i> <b> phone </b> : +91 23456 78910</li>
                                                <li class="mt-2"><i class="ti ti-email text-secondary font-16 align-middle me-2"></i> <b> Email </b> : mannat.theme@gmail.com</li>
                                            }
                                            else
                                            {
                                                <li class=""><i class="ti ti-mobile me-2 text-secondary font-16 align-middle"></i> <b> phone </b> : +@ViewBag.User.PhoneNumber</li>
                                                <li class="mt-2"><i class="ti ti-email text-secondary font-16 align-middle me-2"></i> <b> Email </b> : @ViewBag.User.Email</li>
                                            }
                                        </ul>

                                    </div><!--end col-->

                                </div><!--end row-->
                            </div><!--end f_profile-->
                        </div><!--end card-body-->
                    </div> <!--end card-->
                </div><!--end col-->
            </div><!--end row-->
            <div class="pb-4">
                <ul class="nav-border nav nav-pills mb-0" id="pills-tab" role="tablist">

                    <li class="nav-item">
                        <a class="nav-link active " id="settings_detail_tab" data-bs-toggle="pill" href="#Profile_Settings">Settings</a>
                    </li>
                </ul>
            </div><!--end card-body-->
            <div class="row">
                <div class="col-12">
                    <div class="tab-content" id="pills-tabContent">

                        <div class="tab-pane fade show active" id="Profile_Settings" role="tabpanel" aria-labelledby="settings_detail_tab">
                            <div class="row">
                                <!--end col-->
                                <div class="col-lg-6 col-xl-6">
                                    <div class="card">
                                        <div class="card-header">
                                            <h4 class="card-title">Change Password</h4>
                                        </div><!--end card-header-->
                                        @*@using (Html.BeginForm("Edit", "Admin", FormMethod.Post))
                                        {*@
                                        <form id="editform" method="post" action="@Url.Action("ChangePass", "Admin")">
                                            <div class="card-body">
                                                <div class="form-group row">
                                                    <label class="col-xl-3 col-lg-3 text-end mb-lg-0 align-self-center">Current Password</label>
                                                    <div class="col-lg-9 col-xl-8">
                                                        <input id="oldpassED" name="oldpass" class="form-control" type="password" placeholder="Password">
                                                        <div id="oldpasserr" class="error"></div>

                                                        @*<a href="#" class="text-primary font-12">Forgot password ?</a>*@
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label class="col-xl-3 col-lg-3 text-end mb-lg-0 align-self-center">New Password</label>
                                                    <div class="col-lg-9 col-xl-8">
                                                        <input id="newpassED" name="newpass" class="form-control" type="password" placeholder="New Password">
                                                        <div id="newpasserr" class="error"></div>

                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label class="col-xl-3 col-lg-3 text-end mb-lg-0 align-self-center">Confirm Password</label>
                                                    <div class="col-lg-9 col-xl-8">
                                                        <input id="renewpassED" class="form-control" type="password" placeholder="Re-Password">
                                                        <div id="renewpasserr" class="error"></div>

                                                        <span class="form-text text-muted font-12">Never share your password.</span>
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <div class="col-lg-9 col-xl-8 offset-lg-3">
                                                        @if (ViewBag.User != null)
                                                        {
                                                            <input type="hidden" name="idhidden" value="@ViewBag.User.Id"></input>
                                                        }
                                                        else
                                                        {
                                                            <input type="hidden" name="idhidden" value="0"></input>
                                                        }
                                                        <button id="editbtn" onclick="validateform()" type="submit" class="btn btn-sm btn-outline-primary">Change Password</button>
                                                        @*<button type="button" class="btn btn-sm btn-outline-danger">Cancel</button>*@
                                                    </div>
                                                </div>
                                            </div>
                                        </form>

                                        <!--end card-body-->
                                        @*}*@

                                    </div><!--end card-->




                                </div> <!-- end col -->

                            </div><!--end row-->
                        </div><!--end tab-pane-->
                    </div><!--end tab-content-->
                </div><!--end col-->
            </div><!--end row-->

        </div><!-- container -->

        <footer class="footer text-center text-sm-start">
            &copy; <script>
                       document.write(new Date().getFullYear())
            </script> G5 Manager <span class="text-muted d-none d-sm-inline-block float-end">
                Crafted with <i class="mdi mdi-heart text-danger"></i> by  G5 Manager
            </span>
        </footer><!--end footer-->
    </div>
    <!-- end page content -->
</div>
<!-- end page-wrapper -->

<script>
    function validateform() {
        var form = document.getElementById("editform");
        var submitButton = document.getElementById("editbtn");

        // Add an event listener to the form for the submit event
        form.addEventListener("submit", function (event) {
            // Prevent the form from submitting
            event.preventDefault();

            // Check if any fields are invalid
            var isFormValid = true;
            var oldpassInput = document.getElementById("oldpassED");
            var passwordInput = document.getElementById("newpassED");
            var repassInput = document.getElementById("renewpassED");

            var oldpassErr = document.getElementById("oldpasserr");
            var newpassErr = document.getElementById("newpasserr");
            var renewpassErr = document.getElementById("renewpasserr");

            var passwordRegex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9]).{6,}$/;

            // Check the email field
            if (oldpassInput == "") {
                isFormValid = false;
                oldpassErr.innerHTML = "Pass is invalid"
                oldpassInput.classList.add("invalid");
            } else {
                oldpassInput.classList.remove("invalid");
            }

            // Check the password field
            if (passwordInput.value == "" || !passwordRegex.test(passwordInput.value)) {
                isFormValid = false;
                newpassErr.innerHTML = "Invalid, min 6 characters, upper, lower, number, special(Ex: A1a@aa)"
                passwordInput.classList.add("invalid");
            } else {
                passwordInput.classList.remove("invalid");
                newpassErr.innerHTML = ""
            }

            if (repassInput.value == "" || repassInput.value !== passwordInput.value) {
                isFormValid = false;
                renewpassErr.innerHTML = "Invalid, not the same password"
                repassInput.classList.add("invalid");
            } else {
                repassInput.classList.remove("invalid");
                renewpassErr.innerHTML = ""
            }


            // Disable the submit button if the form is invalid
            if (!isFormValid) {
                submitButton.disabled = false;
            } else {
                submitButton.disabled = false;
                Swal.fire({
                    title: "Success!",
                    text: "Password changed successfully.",
                    icon: "success",
                    timer: 2000,
                    showConfirmButton: false,
                }).then(() => {
                    // Submit the form after the delay
                    form.submit();
                });
            }
        });
    }


</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css">
<style>
    .error {
        color: red;
        font-size: small;
        margin-bottom: 10px;
    }
</style>